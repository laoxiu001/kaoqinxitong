<!DOCTYPE html>
<!--[if lt IE 7]>

<html class="lt-ie9 lt-ie8 lt-ie7" lang="en">

<![endif]-->
<!--[if IE 7]>

<html class="lt-ie9 lt-ie8" lang="en">

<![endif]-->
<!--[if IE 8]>

<html class="lt-ie9" lang="en">

<![endif]-->
<!--[if gt IE 8]>
<!-->

<html lang="en">

<!--
<![endif]-->
<head>
  <meta charset="utf-8">
  <title>
    考勤系统-打卡测试
  </title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">
  <!-- bootstrap css -->

  <link href="static/icomoon/style.css" rel="stylesheet">
  <link href="static/css/main.css" rel="stylesheet"> <!-- Important. For Theming change primary-color variable in main.css  -->
  <link href="static/css/alertify.core.css" rel="stylesheet" id="toggleCSS">
  <!--[if lte IE 7]>
    <script src="static/css/icomoon-font/lte-ie7.js">
    </script>
    <![endif]-->

</head>
<body onload="message('success','跳转成功');">
<!-- 头部状态栏 start -->
<header>
  <a href="#" class="logo">
    <img src="static/img/logo.png" alt="Logo"/>
  </a>
  <div class="btn-group">
    <button class="btn btn-primary">
      早上好，admin ！
    </button>
    <button data-toggle="dropdown" class="btn btn-primary dropdown-toggle">
          <span class="caret">
          </span>
    </button>
    <ul class="dropdown-menu pull-right">
      <li>
        <a href="#myModal" role="button" data-toggle="modal">
          修改密码
        </a>
      </li>
      <li>
        <a href="#">
          注销账户
        </a>
      </li>
    </ul>
  </div>
</header>
<!-- 头部状态栏 end -->
<!-- 主体内容 start -->
<div class="container-fluid">
  <div class="dashboard-container">
    <!--头部主导航栏-->
    <div class="top-nav">
      <ul>
        <li>
          <a href="punch.html" class="selected">
            <div class="fs1" aria-hidden="true" data-icon="&#xe0a0;"></div>
            打卡测试
          </a>
        </li>
        <li>
          <a href="employeeManage.html">
            <div class="fs1" aria-hidden="true" data-icon="&#xe072;"></div>
            员工信息
          </a>
        </li>
        <li>
          <a href="department.html">
            <div class="fs1" aria-hidden="true" data-icon="&#xe0a9;"></div>
            部门信息
          </a>
        </li>
        <li>
          <a href="position.html">
            <div class="fs1" aria-hidden="true" data-icon="&#xe073;"></div>
            职位管理
          </a>
        </li>
        <li>
          <a href="leaveRecord.html">
            <div class="fs1" aria-hidden="true" data-icon="&#xe0e4;"></div>
            请假管理
          </a>
        </li>
        <li>
          <a href="shiftManagement.html">
            <div class="fs1" aria-hidden="true" data-icon="&#xe075;"></div>
            班次管理
          </a>
        </li>
        <li>
          <a href="attence.html">
            <div class="fs1" aria-hidden="true" data-icon="&#xe096;"></div>
            考勤管理
          </a>
        </li>
        <li>
          <a href="result.html">
            <div class="fs1" aria-hidden="true" data-icon="&#xe0b8;"></div>
            考勤结果管理
          </a>
        </li>
      </ul>
      <div class="clearfix">
      </div>
    </div>
    <!--头部副导航栏-->
    <div class="sub-nav">
      <ul>
        <li><a href="#" class="heading">打卡测试</a></li>
      </ul>
    </div>
    <div class="dashboard-wrapper">
      <div class="left-sidebar">

        <div class="row-fluid">

          <div class="span12">
            <!-- 查询员工 -->
            <div class="widget">
              <div class="widget-header" id="search">
                <div class="title">
                  查询员工
                </div>
                <span class="tools">
                      <a class="fs1" aria-hidden="true" data-icon="&#xe090;"></a>
                    </span>
              </div>
              <div class="widget-body">
                <div class="span1"></div>
                <div class="span10">
                  <div class="sign-in-container">
                    <!-- 员工信息查询输入框 -->
                    <form class="form-horizontal span12" onsubmit="return punch_search()">
                      <table>
                        <div class="control-group">
                          <label class="control-label">
                            员工工号：
                          </label>
                          <div class="controls">
                            <div class="input-append">
                              <input type="text" placeholder="请输入员工工号" id="search_number" name="" onkeyup="punch_search()">
                              <input class="btn btn-danger" type="button" value="查询">
                            </div>
                          </div>
                          <div class="controls">
                            <span style="color: red;" id="span_search"></span>
                          </div>
                        </div>
                      </table>
                    </form>
                  </div>
                </div>
                <div class="span1"></div>
                <div class="clearfix"></div>
              </div>
            </div>
            <!-- 员工信息 -->
            <div class="widget">
              <div class="widget-header" id="punch">
                <div class="title">
                  员工打卡
                </div>
                <span class="tools">
                      <a class="fs1" aria-hidden="true" data-icon="&#xe090;"></a>
                    </span>
              </div>
              <div class="widget-body">
                <div class="span1"></div>
                <div class="span10">
                  <div class="sign-in-container">
                    <!-- 员工信息框 -->
                    <form action="#" class="form-horizontal span12" id="punchForm">
                      <div class="span8">
                        <div class="control-group">
                          <label class="control-label">
                            员工工号：
                          </label>
                          <div class="controls controls-row">
                            <input class="span6" id="inf_number" type="text" name="userId" readonly>
                          </div>
                        </div>
                        <div class="control-group">
                          <label class="control-label">
                            员工姓名：
                          </label>
                          <div class="controls controls-row">
                            <input class="span6" id="inf_name" type="text" readonly>
                          </div>
                        </div>
                        <div class="control-group">
                          <label class="control-label">
                            手机号：
                          </label>
                          <div class="controls controls-row">
                            <input class="span6" id="inf_phone" type="text" readonly>
                          </div>
                        </div>
                        <div class="control-group">
                          <label class="control-label">
                            所属部门：
                          </label>
                          <div class="controls controls-row">
                            <input class="span6" id="inf_department" type="text" readonly>
                          </div>
                        </div>
                        <div class="control-group">
                          <label class="control-label">
                            职位：
                          </label>
                          <div class="controls controls-row">
                            <input class="span6" id="inf_position" type="text" readonly>
                          </div>
                        </div>
                        <div class="control-group">
                          <label class="control-label">
                            班次：
                          </label>
                          <div class="controls controls-row">
                            <input class="span6" id="inf_shift_id" type="text" readonly>
                          </div>
                        </div>
                        <div class="control-group">
                          <label class="control-label">
                            在职状态：
                          </label>
                          <div class="controls controls-row">
                            <input class="span6" id="inf_status" type="text" readonly>
                          </div>
                        </div>
                      </div>
                      <div class="span3">
                        <div class="control-group">
                          <div class="thumbnail">
                            <img alt="300x200" src="static/img/photo.jpg">
                            <div class="caption">
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="span8">
                        <div class="control-group">
                          <div class="controls controls-row">
                            <button class="btn btn-success" type="button" onclick="punch()">打卡</button>
                            <span style="color: red;" id="span_punch"></span>
                          </div>
                        </div>
                      </div>
                    </form>
                  </div>
                </div>
                <div class="span1"></div>
                <div class="clearfix"></div>
              </div>
            </div>
          </div>

        </div>


      </div>

      <!-- 右边员工预览 -->
      <div class="right-sidebar">
        <div class="wrapper">
          <ul class="stats">
            <li>
              <div class="metro-nav-block nav-block-yellow current">
                <a href="#">
                  <div class="brand">
                    <div class="pull-left fs1" aria-hidden="true" data-icon="&#xe000;"></div>
                    <p class="pull-left">&nbsp;部门员工数：</p>
                    <h3 class="pull-right">15,859</h3>
                    <div class="clearfix"></div>
                  </div>
                </a>
              </div>
            </li>
            <li>
              <div class="metro-nav-block nav-block-yellow current">
                <a href="#">
                  <div class="brand">
                    <div class="pull-left fs1" aria-hidden="true" data-icon="&#xe01b;"></div>
                    <p class="pull-left">&nbsp;今日应到人数：</p>
                    <h3 class="pull-right">15,857</h3>
                    <div class="clearfix"></div>
                  </div>
                </a>
              </div>
            </li>
            <li>
              <div class="metro-nav-block nav-block-yellow current">
                <a href="#">
                  <div class="brand">
                    <div class="pull-left fs1" aria-hidden="true" data-icon="&#xe070;"></div>
                    <p class="pull-left">&nbsp;今日实到人数：</p>
                    <h3 class="pull-right">15,853</h3>
                    <div class="clearfix"></div>
                  </div>
                </a>
              </div>
            </li>
            <li>
              <div class="metro-nav-block nav-block-yellow current">
                <a href="#">
                  <div class="brand">
                    <div class="pull-left fs1" aria-hidden="true" data-icon="&#xe006;"></div>
                    <p class="pull-left">&nbsp;请假人数：</p>
                    <h3 class="pull-right">2</h3>
                    <div class="clearfix"></div>
                  </div>
                </a>
              </div>
            </li>
            <li>
              <div class="metro-nav-block nav-block-yellow current">
                <a href="#">
                  <div class="brand">
                    <div class="pull-left fs1" aria-hidden="true" data-icon="&#xe04b;"></div>
                    <p class="pull-left">&nbsp;缺勤人数：</p>
                    <h3 class="pull-right">4</h3>
                    <div class="clearfix"></div>
                  </div>
                </a>
              </div>
            </li>
          </ul>
        </div>

      </div>

    </div>
  </div>
  <!--/.fluid-container-->
</div>
<!-- 主体内容 end -->
<!-- 修改密码模态框 start -->
<div id="myModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
      ×
    </button>
    <h3 id="myModalLabel">
      <a class="fs1" aria-hidden="true" data-icon="&#xe1c8;"></a>
      修改密码
    </h3>
  </div>
  <form class="form-horizontal no-margin" id="passwordForm">
    <table>
      <div class="modal-body">
        <div class="tab-content" id="myTabContent">
          <div id="step1" class="tab-pane fade active in">

            <div class="control-group">
              <label class="control-label" for="password">
                当前密码
              </label>
              <div class="controls">
                <input type="password" id="password" name="currencyPassword" placeholder="请输入当前密码" onkeyup="changePassword()">
                <span style="color: red;" id="span_password"></span>
              </div>
            </div>
            <div class="control-group">
              <label class="control-label" for="newPassword_1">
                修改密码
              </label>
              <div class="controls">
                <input type="password" id="newPassword_1" name="newPassword" placeholder="请输入要修改的密码" onkeyup="changePassword()">
                <span style="color: red;" id="span_newPassword_1"></span>
              </div>
            </div>
            <div class="control-group">
              <label class="control-label" for="newPassword_2">
                确认密码
              </label>
              <div class="controls">
                <input type="password" id="newPassword_2" name="confirmPassword" placeholder="请确认要修改的密码" onkeyup="changePassword()">
                <span style="color: red;" id="span_newPassword_2"></span>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-primary" type="button" onclick="changePassword()">
          提交
        </button>
        <button class="btn" data-dismiss="modal" aria-hidden="true">
          关闭
        </button>
      </div>
    </table>
  </form>
</div>
<!-- 修改密码模态框 end -->
<!-- 底部footer start -->
<footer>
  <p>
    &copy; 雷格SS Copyright 2018 Powered by Bootstrap! F1.0  备：沪ICP备41749849号-3
  </p>
</footer>
<!-- 底部footer end -->


<script src="static/js/jquery.min.js">
</script>
<script src="static/js/bootstrap.js">
</script>
<script type="text/javascript" src="static/js/alertify.min.js">
</script>
//主JS代码
<script type="text/javascript" src="static/js/main.js">
</script>
<script>
    /*
    * 点击查询员工信息执行方法：
    * 一旦员工工号输入框内容改变，就执行该方法动态查询员工信息
    *
    * 传入值：
    *   员工工号：search_number
    * 返回值：
    *   员工工号：inf_number
    *   员工姓名：inf_name
    *   员工手机号：inf_phone
    *   员工所在部门：inf_department
    *   员工职位：inf_position
    *   员工班次：inf_shift_id
    *   员工状态（在/离职）：inf_status
    * */
function search_ajax() {
  $.ajax({
    cache: false,
    type: "GET",
    url:"static/data/punch.txt",
    data: 'search_number=' + search_number,
    dataType : 'json',
    async : false,
    error: function(request) {
      console.log(request.error);
    },
    success: function(data) {
        $('#inf_number').val(data.number);
        $('#inf_name').val(data.name);
        $('#inf_phone').val(data.phone);
        $('#inf_department').val(data.department);
        $('#inf_position').val(data.position);
        $('#inf_shift_id').val(data.shift_id);
        $('#inf_status').val(data.status);
    }
  });
}
    /*
    * 查询员工信息按钮功能
    * */
    function punch_search() {
      document.getElementById("span_search").innerHTML='';
      var number = document.getElementById('search_number').value;
      //清空span内容
      if (number == ""){
        document.getElementById("span_search").innerHTML='员工工号为空';
        return false;
      }else if(isNaN(number)){
        document.getElementById("span_search").innerHTML='请输入数字';
        return false;
      }
      search_ajax();
      return true;
    }

    /*
    * 打卡按钮功能
    * */
    function punch() {
      //清空span内容
      document.getElementById("span_punch").innerHTML='';
      var number = document.getElementById('inf_number').value;
      if (number == ""){
        document.getElementById("span_punch").innerHTML='员工工号为空';
        return false;
      }
      //获取表单数据
      var punchFormJson = $('#punchForm').serializeArray();
      //构造请求参数
      var punchSubmitJson = {
        userId: parseInt(punchFormJson[0].value,10),
        address: '重庆市永川区重庆文理学院'
      };
      $.ajax({
        catch: false,
        type: "POST",
        url: "/attend/insert",
        data: punchSubmitJson,
        async: false,
        success: function (data) {
          if (data == "SUCCESS") {
            //打卡成功
            message('success', '打卡成功');
          } else if(data == "fail"){
            //打卡失败
            message('error', '打卡失败');
          }else {
            //其他错误信息
            message('error', 'data');
          }
        }
      })
    }
</script>
</body>
</html>